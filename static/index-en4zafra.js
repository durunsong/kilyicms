import{y as se,z as A,A as B,B as k,L as Z,E as O,D as j,P as x,r as v,l as G,f as ce,X as de,al as M,R as r,u as c,J as h,aD as fe,O as q,I as J,T as me,a4 as te}from"./vue-CDBYdBif.js";import{L as ve,_ as pe}from"./index-Bq2sV6AA.js";import{d as re,_ as ie,f as _e,k as ge}from"./index-n9fM5Zhe.js";import{o as he,u as oe,p as H,a as we}from"./element-BaWQJB8U.js";const be="/kilyicms/static/logo-text-2-BAee3GBA.png",z=Math.PI;function ae(e,l){return e+l}function ye(e){return e*e}function ne(e,l,o,s,n,u){e.beginPath(),e.moveTo(l,o),e.arc(l+s/2,o-n+2,n,.72*z,2.26*z),e.lineTo(l+s,o),e.arc(l+s+n-2,o+s/2,n,1.21*z,2.78*z),e.lineTo(l+s,o+s),e.lineTo(l,o+s),e.arc(l+n-2,o+s/2,n+.4,2.76*z,1.24*z,!0),e.lineTo(l,o),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[u](),e.globalCompositeOperation="destination-over"}function ke(e,l){const o=document.createElement("img");return o.crossOrigin="Anonymous",o.onload=l,o.onerror=()=>{o.src=ee(e)},o.src=ee(e),o}function K(e,l){return Math.round(Math.random()*(l-e)+e)}function ee(e){const l=e.length;return l>0?e[K(0,l-1)]:"https://picsum.photos/300/150?image="+K(0,1084)}function Ce(e,l,o={leading:!0,trailing:!0}){const{leading:s,trailing:n,resultCallback:u}=o;let t=0,p=null;const w=function(...a){return new Promise((_,g)=>{const d=new Date().getTime();!t&&!s&&(t=d);const f=l-(d-t);if(f<=0){p&&(clearTimeout(p),p=null);const m=e.apply(this,a);u&&u(m),_(m),t=d;return}n&&!p&&(p=setTimeout(()=>{p=null,t=s?new Date().getTime():0;const m=e.apply(this,a);u&&u(m),_(m)},f))})};return w.cancel=function(){p&&clearTimeout(p),p=null,t=0},w}function Te(){const e=G({x:0,y:0}),l=v(!1),o=v(!1),s=v(0),n=v([]);return{origin:e,success:l,isMouseDown:o,timestamp:s,trail:n,start:a=>{l.value||(a instanceof MouseEvent?(e.x=a.clientX,e.y=a.clientY):(e.x=a.changedTouches[0].pageX,e.y=a.changedTouches[0].pageY),o.value=!0,s.value=Date.now())},move:(a,_,g)=>{if(!o.value)return!1;let d=0,f=0;if(_ instanceof MouseEvent?(d=_.clientX-e.x,f=_.clientY-e.y):(d=_.changedTouches[0].pageX-e.x,f=_.changedTouches[0].pageY-e.y),d<0||d+38>=a)return!1;g(d),n.value.push(f)},end:(a,_)=>{if(!o.value||(o.value=!1,(a instanceof MouseEvent?a.clientX:a.changedTouches[0].pageX)===e.x))return!1;s.value=Date.now()-s.value,_(s.value)},verify:(a,_,g)=>{const d=n.value,f=d.reduce(ae)/d.length,m=d.map(S=>S-f),T=Math.sqrt(m.map(ye).reduce(ae)/d.length),V=parseInt(a);return g=g<=1?1:g>10?10:g,{spliced:Math.abs(V-_)<=g,TuringTest:f!==T}}}}var Ve=(e,l)=>{const o=e.__vccOpts||e;for(const[s,n]of l)o[s]=n;return o};const Se=se({name:"SlideVerify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"},accuracy:{type:Number,default:5},show:{type:Boolean,default:!0},imgs:{type:Array,default:()=>[]},interval:{type:Number,default:50},offset:{type:Number,default:0}},emits:["success","again","fail","refresh"],setup(e,{emit:l}){const{imgs:o,l:s,r:n,w:u,h:t,accuracy:p,interval:w,offset:a}=e,_=v(!0),g=v(0),d=v(0),f=G({containerActive:!1,containerSuccess:!1,containerFail:!1}),m=G({iconCls:"arrow-right",width:"0",left:"0"}),T=v(),V=v(),S=v(),R=v();let b;const{success:i,start:F,move:W,end:D,verify:E}=Te(),N=()=>{var C,P;i.value=!1,f.containerActive=!1,f.containerSuccess=!1,f.containerFail=!1,m.iconCls="arrow-right",m.left="0",m.width="0",T.value.style.left="0",(C=R.value)==null||C.clearRect(0,0,u,t),(P=V.value)==null||P.clearRect(0,0,u,t),T.value.width=u,b.src=ee(o)},X=()=>{N(),l("refresh")};function Y(C){m.left=C+"px";let P=(u-40-20)/(u-40)*C;T.value.style.left=P+"px",f.containerActive=!0,m.width=C+"px"}function Q(C){const P=T.value.style.left,{spliced:L,TuringTest:$}=E(P,g.value,p);if(L){if(p===-1){f.containerSuccess=!0,m.iconCls="success",i.value=!0,l("success",{timestamp:C,left:parseFloat(P)});return}$?(f.containerSuccess=!0,m.iconCls="success",i.value=!0,l("success",{timestamp:C,left:parseFloat(P)})):(f.containerFail=!0,m.iconCls="fail",l("again"))}else f.containerFail=!0,m.iconCls="fail",l("fail"),setTimeout(()=>{N()},1e3)}const U=Ce(C=>{W(u,C,Y)},w),y=C=>{D(C,Q)};return ce(()=>{var C,P;const L=(C=S.value)==null?void 0:C.getContext("2d"),$=(P=T.value)==null?void 0:P.getContext("2d",{willReadFrequently:!0});R.value=L,V.value=$,b=ke(o,()=>{_.value=!1;const I=s+n*2+3;if(a>0)if(a>=I+10&&a<=u-(I+10))g.value=a;else throw new Error(`offset must be greater than ${I+10} and less than ${u-(I+10)}`);else g.value=K(I+10,u-(I+10));if(d.value=K(10+n*2,t-(I+10)),L&&$){ne(L,g.value,d.value,s,n,"fill"),ne($,g.value,d.value,s,n,"clip"),L.drawImage(b,0,0,u,t),$.drawImage(b,0,0,u,t);const le=d.value-n*2-1,ue=$.getImageData(g.value,le,I,I);T.value.width=I,$.putImageData(ue,0,le)}}),document.addEventListener("mousemove",U),document.addEventListener("mouseup",y)}),de(()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",y)}),{block:T,canvas:S,loadBlock:_,containerCls:f,sliderBox:m,refresh:X,sliderDown:F,touchStartEvent:F,touchMoveEvent:U,touchEndEvent:y}}}),Ee=["width","height"],Pe=["width","height"],Ie={class:"slide-verify-slider-text"};function Me(e,l,o,s,n,u){return B(),A("div",{id:"slideVerify",class:"slide-verify",style:j({width:e.w+"px"}),onselectstart:"return false;"},[k("div",{class:O({"slider-verify-loading":e.loadBlock})},null,2),k("canvas",{ref:"canvas",width:e.w,height:e.h},null,8,Ee),e.show?(B(),A("div",{key:0,class:"slide-verify-refresh-icon",onClick:l[0]||(l[0]=(...t)=>e.refresh&&e.refresh(...t))},l[5]||(l[5]=[k("i",{class:"iconfont icon-refresh"},null,-1)]))):Z("",!0),k("canvas",{ref:"block",width:e.w,height:e.h,class:"slide-verify-block"},null,8,Pe),k("div",{class:O(["slide-verify-slider",{"container-active":e.containerCls.containerActive,"container-success":e.containerCls.containerSuccess,"container-fail":e.containerCls.containerFail}])},[k("div",{class:"slide-verify-slider-mask",style:j({width:e.sliderBox.width})},[k("div",{class:"slide-verify-slider-mask-item",style:j({left:e.sliderBox.left}),onMousedown:l[1]||(l[1]=(...t)=>e.sliderDown&&e.sliderDown(...t)),onTouchstart:l[2]||(l[2]=(...t)=>e.touchStartEvent&&e.touchStartEvent(...t)),onTouchmove:l[3]||(l[3]=(...t)=>e.touchMoveEvent&&e.touchMoveEvent(...t)),onTouchend:l[4]||(l[4]=(...t)=>e.touchEndEvent&&e.touchEndEvent(...t))},[k("i",{class:O(["slide-verify-slider-mask-item-icon","iconfont",`icon-${e.sliderBox.iconCls}`])},null,2)],36)],4),k("span",Ie,x(e.sliderText),1)],2)],4)}var Be=Ve(Se,[["render",Me],["__scopeId","data-v-617ae856"]]);const Re="/kilyicms/static/slideimg-1--qdnIjPW.png",$e="/kilyicms/static/slideimg-2-DwQUL8ig.png",xe="/kilyicms/static/slideimg-3-BzV2SpF7.png",De="/kilyicms/static/slideimg-4-BN6kYQr-.png",Ne="/kilyicms/static/slideimg-5-BnLnt_Rw.png",Ae="/kilyicms/static/slideimg-6-Cwx9GuW1.png",Le={class:"slide_box1"},ze={class:"slide_inner_box"},Fe=se({__name:"index",emits:["again","success","fail","refresh","close"],setup(e,{emit:l}){const{t:o}=re(),s=v(""),n=v([Re,$e,xe,De,Ne,Ae]),u=v(),t=l,p=v(""),w=v(0),a=v(!1),_=()=>{a.value||(w.value=Date.now(),a.value=!0)},g=()=>{s.value=o("non_human_operation_detected"),p.value="red",a.value=!1,w.value=0,u.value?.refresh()},d=V=>{let S=0;a.value&&w.value>0?S=Date.now()-w.value:typeof V=="number"&&!isNaN(V)&&V>0?S=V:S=1e3,s.value=o("successful_which_takes")+(S/1e3).toFixed(1)+o("seconds"),p.value="green",a.value=!1,w.value=0,t("success")},f=()=>{s.value="",t("close")},m=()=>{s.value=o("Verification_failed"),p.value="red",a.value=!1,w.value=0,setTimeout(()=>{s.value=""},1e3)},T=()=>{s.value="",a.value=!1,w.value=0};return(V,S)=>{const R=M("el-button");return B(),A("div",Le,[r(R,{icon:c(he),size:"small",class:"slider_close_btn",circle:"",onClick:f},null,8,["icon"]),k("div",ze,[r(c(Be),{class:"slide_box",ref_key:"block",ref:u,"slider-text":c(o)("swipe_right"),accuracy:5,onAgain:g,onSuccess:d,onFail:m,onRefresh:T,onMousedown:_,onTouchstart:_,imgs:n.value},null,8,["slider-text","imgs"]),k("div",{class:"msg_box",style:j("color:"+p.value)},x(s.value),5)])])}}}),Ue=ie(Fe,[["__scopeId","data-v-2f27a6b2"]]),qe={class:"login_container"},Xe={class:"theme-switch-container"},Ye={key:0},Oe={key:1},je={key:0,class:"slide_verify_right"},Ge={class:"button_side"},Ke={class:"toggle-form button_login_side"},We={class:"button_side"},Qe={class:"toggle-form button_register_side"},Je=se({__name:"index",setup(e){const l=v(!1),o=v(!1),{t:s}=re(),n=v(!1),u=fe(),t=G({user_name:"admin",password:"123456",confirmPassword:void 0,roles:void 0}),p=v("admin"),w=v(null),a=v(!1),_={user_name:[{required:!0,message:s("Please_enter_your_username"),trigger:"blur"}],password:[{required:!0,message:s("Please_enter_your_password"),trigger:"blur"}]},g={user_name:[{required:!0,message:s("Please_enter_your_username"),trigger:"blur"}],password:[{required:!0,message:s("Please_enter_your_password"),trigger:"blur"}],confirmPassword:[{required:!0,message:s("Please_confirm_the_password"),trigger:"blur"}],roles:[{required:!0,message:s("Please_select_your_role"),trigger:"blur"}]},d=b=>{b==="admin"?Object.assign(t,{user_name:"admin",password:"123456",confirmPassword:void 0,roles:void 0}):Object.assign(t,{user_name:"user",password:"123456",confirmPassword:void 0,roles:void 0})},f=()=>{setTimeout(()=>{o.value=!0,l.value=!1,m()},1e3)},m=()=>{n.value=!0;const b=t;_e().login(b).then(()=>{const i=u.currentRoute.value.query.redirect||"/";u.push(decodeURIComponent(i))}).finally(()=>{n.value=!1})},T=()=>{w.value?.validate(b=>{b?o.value?m():l.value=!0:n.value=!1})},V=()=>{a.value=!a.value,o.value=!1},S=()=>{n.value=!0;const b=t;b.roles=[b.roles],ge(b).then(i=>{i.status===200&&(we({message:i.message,type:"success"}),V())}).finally(()=>{n.value=!1})},R=()=>{const b=t;Array.isArray(b.roles)&&(b.roles=void 0),w.value?.validate(i=>{i&&S()})};return(b,i)=>{const F=M("el-radio-button"),W=M("el-radio-group"),D=M("el-input"),E=M("el-form-item"),N=M("el-button"),X=M("el-form"),Y=M("el-option"),Q=M("el-select"),U=M("el-card");return B(),A("div",qe,[k("div",Xe,[r(ve),r(pe,{class:"theme-switch"})]),r(U,{class:O(["box_login_card",a.value?"box_card_style":""])},{default:h(()=>[i[8]||(i[8]=k("div",{class:"title"},[k("img",{src:be})],-1)),a.value?(B(),A("h3",Oe,x(c(s)("user_register")),1)):(B(),A("h3",Ye,[q(x(c(s)("user_login"))+" ",1),a.value?Z("",!0):(B(),J(W,{key:0,modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=y=>p.value=y),onChange:d},{default:h(()=>[r(F,{label:"admin",value:"admin"}),r(F,{label:"user",value:"user"})]),_:1},8,["modelValue"]))])),r(me,{name:"el-fade-in-linear"},{default:h(()=>[a.value?(B(),J(X,{key:1,model:t,rules:g,class:"register_form",ref_key:"ref_form",ref:w,onKeyup:te(R,["enter"])},{default:h(()=>[r(E,{prop:"user_name",label:c(s)("user_name"),"label-width":"100px"},{default:h(()=>[r(D,{modelValue:t.user_name,"onUpdate:modelValue":i[4]||(i[4]=y=>t.user_name=y),modelModifiers:{trim:!0},placeholder:c(s)("Please_enter_your_username"),size:"large","prefix-icon":c(oe)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1},8,["label"]),r(E,{prop:"password",label:c(s)("password"),"label-width":"100px"},{default:h(()=>[r(D,{size:"large",modelValue:t.password,"onUpdate:modelValue":i[5]||(i[5]=y=>t.password=y),modelModifiers:{trim:!0},"show-password":"",placeholder:c(s)("Please_confirm_the_password"),"prefix-icon":c(H)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1},8,["label"]),r(E,{prop:"confirmPassword",label:c(s)("confirm_password"),"label-width":"100px"},{default:h(()=>[r(D,{size:"large",modelValue:t.confirmPassword,"onUpdate:modelValue":i[6]||(i[6]=y=>t.confirmPassword=y),modelModifiers:{trim:!0},"show-password":"",placeholder:c(s)("Please_confirm_the_password"),"prefix-icon":c(H)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1},8,["label"]),r(E,{"label-width":"100px",prop:"roles",label:c(s)("character")},{default:h(()=>[r(Q,{modelValue:t.roles,"onUpdate:modelValue":i[7]||(i[7]=y=>t.roles=y),placeholder:c(s)("Selecting_a_Character")},{default:h(()=>[r(Y,{size:"large",label:"Admin",value:"admin"}),r(Y,{size:"large",label:"User",value:"user"})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r(E,null,{default:h(()=>[k("div",We,[r(N,{class:"submit_but",type:"primary",onClick:R,loading:n.value},{default:h(()=>[q(x(c(s)("router_register")),1)]),_:1},8,["loading"])])]),_:1}),r(E,null,{default:h(()=>[k("div",Qe,[r(N,{class:"side_btn",link:"",onClick:V},{default:h(()=>[q(x(c(s)("Go_and_log_in")),1)]),_:1})])]),_:1})]),_:1},8,["model"])):(B(),J(X,{key:0,model:t,rules:_,class:"login_form",ref_key:"ref_form",ref:w,onKeyup:te(T,["enter"])},{default:h(()=>[r(E,{prop:"user_name",label:c(s)("user_name"),"label-width":"100px"},{default:h(()=>[r(D,{modelValue:t.user_name,"onUpdate:modelValue":i[1]||(i[1]=y=>t.user_name=y),modelModifiers:{trim:!0},placeholder:c(s)("Please_enter_your_username"),size:"large","prefix-icon":c(oe)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1},8,["label"]),r(E,{prop:"password",label:c(s)("password"),"label-width":"100px"},{default:h(()=>[r(D,{size:"large",modelValue:t.password,"onUpdate:modelValue":i[2]||(i[2]=y=>t.password=y),modelModifiers:{trim:!0},"show-password":"",placeholder:c(s)("Please_enter_your_password"),"prefix-icon":c(H)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1},8,["label"]),l.value?(B(),A("div",je,[r(Ue,{onSuccess:f,onClose:i[3]||(i[3]=y=>l.value=!1)})])):Z("",!0),r(E,null,{default:h(()=>[k("div",Ge,[r(N,{class:"submit_but",type:"primary",onClick:T,loading:n.value},{default:h(()=>[q(x(c(s)("login")),1)]),_:1},8,["loading"])])]),_:1}),r(E,null,{default:h(()=>[k("div",Ke,[r(N,{class:"side_btn",link:"",onClick:V},{default:h(()=>[q(x(c(s)("Go_to_Register")),1)]),_:1})])]),_:1})]),_:1},8,["model"]))]),_:1})]),_:1},8,["class"])])}}}),ls=ie(Je,[["__scopeId","data-v-70b2e59a"]]);export{ls as default};
